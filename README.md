# FileUploadGit
스프링부트 API 학습용 - 파일 업로드



## ★해야할일★


    //09-01이슈
    //엔트리를 가져와 새로운 파일에 덮어쓰는 코드를 구현했지만, 원본과 너무 다를뿐더러, 원본이 ole를 가지고 있는 문서이면,
    //기존 알고있는 ole구조가 틀어져, 추출된 문서에 연결된 ole를 불러올 수가 없음. 
    //이를 통해 97-03 - 97-03버전 문제와, hwp doc 문제를 해결할 수 없음.

    //9월 3일 발견한 이슈~~ 매우 중요!!
    //한컴 문서에서 연결된 docx의 문서의 경우, 0XFF로 대부분이 채워지는 현상이 있었음,
    //확인해 보니, 한컴은 zlib를 통해 압축을 해왔음,
    //복호화를 시도했지만, 잘 안됬음 -> 집에서 한컴이랑 docx를 새로 만들어서 테스트를 해보니, 잘 됬음...?
    //두 hwp의 차이점이라고는, docx의 연결프로그램이 word냐 한컴워드이냐인데, 한컴워드이면 Package엔트리가 생성이 안됬음....
    //결론: 자회사 제품의 ole연결에 한해서 매우 짜증나는 현상,,,
    //hwp에서 docx를 추출하는데 결국 성공함!~


    //9월 5일자 이슈!!
    //DOC나 DOCX에서 XLSX와 같은 스프레드 시트를 연결 후, 추출하면 시트가 안보이는 현상이 있었음
    //확인해 보니, 내가 생성했던 파일을 그대로 넣으면, 시트가 없어지고
    //객체 새로생성으로 넣으면 시트가 잘보임 ㅋㅋㅋㅋ

    //97-03버전에 한컴연결은, 97-03에 97-03을 연결하는것과 같다

    /*
    ※ 공통사항 -워드프로세서 문서는 전부 시도 안함(이거는 데이터 자체가 없음)
    만약 ole이름이 같으면, 추가 조치 진행하기

    doc 파일 개선사항 - hwp추출이 안됨(97-03, 97-03이슈랑 같음), 파일명-완벽
    docx 파일 개선사항 - hwp이름만 수정하면 될 듯
    hwp 파일 개선사항 - 97-03버전의 이름만 찾으면 될 듯 -> 해결 완료
    ppt 파일 개선사항 - hwp추출이 안됨(97-03, 97-03이슈랑 같음), 파일명-완벽
    pptx파일 개선사항 - hwp이름만 수정하면 될 듯
    xls파일 개선사항 - hwp추출이 안됨(97-03, 97-03이슈랑 같음), 파일 확장자 null오류 발견!
                    -> xls의 compobj에 확장자를 식별할 문자열이 없어서 파일명으로 구별
    xlsx파일 개선사항 - hwp이름만 수정하면 될 듯


    --번외--
    자동 입력시
    doc 파일 개선사항 - hwp추출이 안됨(97-03, 97-03이슈랑 같음) -> 추출 성공 -> 97-03들도 적용하기 및 ole기타 엔트리는 지우기,
                    ->  자동입력된 docx파일은 CompObj엔트리가 없어서 오버라이드 시켜야 할 듯 함->해결함
    docx 파일 개선사항 - hwp이름만 구하면 될 듯함.
    hwp 파일 개선사항 - 자동입력된 docx파일은 CompObj엔트리가 없어서 오버라이드 시켜야 할 듯 함, 97-03버전의 이름 찾으면 됨 -> 해결 완료
    ppt 파일 개선사항 - hwp추출이 안됨(97-03, 97-03이슈랑 같음), docx를 추출하지 못함.->해결함
    pptx 파일 개선사항 - 97-03문서들이 추출 안됨 -> .bin으로 들어감 -> 각 파일별로 특정 엔트리로 구별하는 코드 추가 -> 이름도 추출하는 코드 추가
    xls 파일 개선사항 -  hwp추출이 안됨(97-03, 97-03이슈랑 같음), (특이사항: 엑셀에 엑셀 자동입력이 없음)
    xlsx 파일 개선사항 - hwp이름만 구하면 될 듯함.
    */

    //9월 6일 이슈
    //이제 해야할 것: hwp 파일 이름, 워드프로세서 문서는 전부 시도 안함(이거는 데이터 자체가 없음)
    만약 ole이름이 같으면, 추가 조치 진행하기


    //9월 7일 이슈
    발표할 때, 되는거, 안되는거, 진행중인거 정리해서 발표하기
    close()는 finally로 - try-with-resources도 있음.
    파일 이름 가져오는거(db에 랜덤 이름과 실제 파일명)

    21일 연구소 발표 전 최종 발표연습
    26일 연구소 분들 앞에서 성과 발표

    긴급 수정사항
    문서를 넣고 업로드를 시키면, 추출은 되지만, 추출 후, 스프링으로 결과반환이 안되는 현상이 존재함
    아마도 try-catch문을 넣으면서 생긴 문제인 것 같음 -> 수정하기

    //9월 8일 진행사항
    //db에 파일 원본명이랑, uuid값을 넣고, uuid로 파일을 저장하는 코드 수정중
    //다른거 손댈 필요 없이 parsers코드dml module을 수정하면 됨

    //9월 11일에 해야할것
    //만약 embedded된 이름이 같을 수 있으니 파일명+1과 같이 조치하기
    //중복되거나 불필요한 코드 수정하기

    //9월 12일
    //xoffice에서 hwp추출 오류 수정 -> 수정 끝
    //insert시, super_id값 가져오기 코드 구현

    //9월 13일
    //https://cloudconvert.com/mpeg-converter
    //https://convertio.co/kr/avi-mpeg/
    //를 통해 모든 common-mimetype 테스트 파일 생성하기


    //9월 14일
    //select * (x) -> select colum1, colum2 ... 이런식이 옳다
    //추출에 실패한 파일들은 구현을 해보고, 안되면 안된다고 적기
    //-> 그래도 시도는 계속 해보기
    //문서들 이름 추출 형식 바꾸기 -> ex) ms office word.doc -> 원본명_ole.doc로 바꾸기
    //ExternalFileMap의 코드들 static으로 하지말고 객체를 필요하때 생성해서 사용해야 안전함.
    //csv파일에서 데이터가 sharedStrings.xml라는 파일에 저장이 됨
    //-> 압축이 되어있거나, 별도의 방법으로 저장이 되는 것 같음
    // 구현은 가능할 것 같음....

    9월 15일
    //추출된 엑셀파일의 시트가 안보이는 원인 발견
    <bookViews>
        <workbookView xr2:uid="{A0C1F887-518D-420A-97FE-F65BC950C842}" activeTab="1" windowHeight="8964" 
        windowWidth="17280" yWindow="2304" xWindow="2304" visibility="hidden"/>
    </bookViews>
    태그에서 visibility가 hidden이여서 생기는 문제, 해당 부분을 지우면 출력이 잘 됨을 확인함.
    ->XLSX파일은 성공! 아직 XLS파일 남았다. -> 우선 xls파일은 바이너리 형식이므로 나중에 시도해 보기.

    9월 14일 피드백 반영하기, csv추출 구현하기, 나머지 common mime-Type파일들 테스트해보기
    //수정해야 하는 상황
    -> hwp파일에서 추출할때, 97-2003버전의 확장자가 2번 적용되는 현상 -> 해결 완료
    -> entry가 중복해서 저장되는 현상(저장방식의 문제) -> Ole로 시작하는 엔트리를 안지우니 해결됨
    
    //9월 16일
    //https://poi.apache.org/components/spreadsheet/quick-guide.html#Embedded 참고하기
    //및 코드 전면 수정하기!!

    //9월 17일
    //csv와 rtf 파일(odt, ods, odp는 해결함)은 아직 미해결
    //최근 피드백 적용, hwp파일 추출 다시 구현, 기본 추출 코드 정리(리마스터 작업) 진행하기

    //9월 18일
    //리마스터 작업 완료
    //피드백 적용(hashmap저장 static제거(ConcurrentHashMap로 처리), select(끝), csv(끝), rtf파일)
    //rtf파일과 기본 doc의 특별한 차이점을 찾으면 바로 추출할 수 있을 것 같음

    //9월 21일 피드백
    //문서를 엑셀이나 기타 방법으로 보기 편하게 제작하기(ex: doc 끼리 묶어서 한다거나, 엑셀로 표를 만든다거나)
    //중복되는 코드는 같이 처리될 수 있도록 하기(try - catch 처럼 여러개 쓰여진 코드)
    // parser에서 pPart를 처리하는 인터페이스를 만들어서, pPart의 타입을 확인하고, 그에 맞는 클래스를 호출한다거나 해서
    //지금처럼 EntryHandler에 다 넣기보다 분할할 수 있는 건 분할하기
    //시간날때, 디자인 패턴 공부하기

    //나중에 temp폴더 없으면 생성하도록 수정하기
    //자주 일어나는 현상 - 파일을 쓰는 프로세스를 마치고 다음 프로세스가 진행되어도, ole추출에 대한 프로세스가 살아있음.